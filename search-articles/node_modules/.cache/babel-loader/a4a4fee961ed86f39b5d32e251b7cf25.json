{"ast":null,"code":"var _jsxFileName = \"C:\\\\work-code\\\\mern-again\\\\search-articles\\\\src\\\\routers\\\\AppRouter.js\";\nimport React from \"react\";\nimport { BrowserRouter, Route, Switch } from \"react-router-dom\";\nimport axios from \"axios\";\nimport Header from \"../components/Header\";\nimport Articles from \"../components/Articles\";\nimport Titles from \"../components/Titles\";\nimport Words from \"../components/Words\";\nimport NotFound from \"../components/NotFound\";\nimport { SearchContext } from \"../context/searchContext\";\nimport moment from \"moment\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nclass AppRouter extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      searchword: \"\",\n      articlesFromGNews: [],\n      searchWordsFromDB: [],\n      articleTitlesFromMongo: []\n    };\n    this.handleSearch = this.handleSearch.bind(this);\n    this.sendTitleToDB = this.sendTitleToDB.bind(this);\n  }\n\n  componentDidMount() {\n    // get articles from gNews, 24h old\n    const time = moment().subtract(2, \"days\").toISOString().split(\".\")[0] + \"Z\";\n    fetch(`https://gnews.io/api/v4/search?q=news&in=content&lang=en&from=${time}&max=9&token=ad067a361343c4bbf32705a9be330165`).then(function (response) {\n      return response.json();\n    }).then(data => {\n      this.setState({\n        articlesFromGNews: data.articles\n      });\n    }); // get from mongoDB searchwords arr\n\n    axios.get(\"http://localhost:5000/words\").then(response => {\n      const tempArr = [];\n      response.data.map(object => tempArr.push(object.word));\n      this.setState({\n        searchWordsFromDB: tempArr\n      }); // console.log(\n      //   \"approuter-searchWordsFromDB\",\n      //   this.state.searchWordsFromDB\n      // );\n    }).catch(err => {\n      console.log(err);\n    }); // get titles from mongoDB\n\n    axios.get(\"http://localhost:5000/articles\").then(response => {\n      if (response.data.length > 0) {\n        const arrTitles = [];\n        response.data.map(object => arrTitles.push(object.article));\n        this.setState({\n          articleTitlesFromMongo: arrTitles\n        }); // console.log(\n        //   \"approuter-articleTitlesFromMongo\",\n        //   this.state.articleTitlesFromMongo\n        // );\n      }\n    });\n  }\n\n  handleSearch(searchword, language, from, to) {\n    this.setState({\n      searchword: searchword\n    }); //console.log(\"searchword from handleSearch\", searchword);\n    // send search word to mongoDB\n\n    const word = {\n      word: searchword,\n      count: 1\n    };\n    axios.post(\"http://localhost:5000/words/add\", word).then(response => console.log(\"response.data\", response.data)); // add word to front\n\n    let temparr = this.state.searchWordsFromDB;\n    temparr.push(searchword);\n    this.setState({\n      searchWordsFromDB: temparr\n    }); //console.log(\"adding front\", this.state.searchWordsFromDB);\n    // get gNews articles by searchword\n\n    let wordForSearching = searchword === \"\" ? \"news\" : searchword;\n    fetch(`https://gnews.io/api/v4/search?q=${wordForSearching}&in=content&lang=${language}&from=${from}&to=${to}&max=9&token=ad067a361343c4bbf32705a9be330165`).then(function (response) {\n      return response.json();\n    }).then(data => {\n      this.setState({\n        articlesFromGNews: data.articles\n      }); //console.log(this.state.articlesFromGNews);\n    }); //console.log(this.state.articlesFromGNews);\n  } // send title to mongoDB\n\n\n  sendTitleToDB(title) {\n    //front title arr\n    // let tempTitlearr = this.state.articleTitlesFromMongo;\n    // tempTitlearr.push(title);\n    // this.setState({\n    //   articleTitlesFromMongo: tempTitlearr,\n    // });\n    const articleTitle = {\n      article: title,\n      count: 1\n    }; // send title to mongoDB\n\n    axios.post(\"http://localhost:5000/articles/add\", articleTitle).then(res => console.log(res.data));\n    console.log(\" front-title\", title);\n  }\n\n  render() {\n    const searchContextValue = {\n      handleSearch: this.handleSearch,\n      searchWordsFromDB: this.state.searchWordsFromDB,\n      articlesFromGNews: this.state.articlesFromGNews,\n      articleTitlesFromMongo: this.state.articleTitlesFromMongo,\n      sendTitleToDB: this.sendTitleToDB\n    };\n    return /*#__PURE__*/_jsxDEV(BrowserRouter, {\n      children: /*#__PURE__*/_jsxDEV(SearchContext.Provider, {\n        value: searchContextValue,\n        children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 143,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Switch, {\n          children: [/*#__PURE__*/_jsxDEV(Route, {\n            path: \"/\",\n            component: Articles,\n            exact: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 145,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/titles\",\n            component: Titles\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            path: \"/words\",\n            component: Words\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Route, {\n            component: NotFound\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 144,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 142,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nexport default AppRouter;","map":{"version":3,"sources":["C:/work-code/mern-again/search-articles/src/routers/AppRouter.js"],"names":["React","BrowserRouter","Route","Switch","axios","Header","Articles","Titles","Words","NotFound","SearchContext","moment","AppRouter","Component","constructor","props","state","searchword","articlesFromGNews","searchWordsFromDB","articleTitlesFromMongo","handleSearch","bind","sendTitleToDB","componentDidMount","time","subtract","toISOString","split","fetch","then","response","json","data","setState","articles","get","tempArr","map","object","push","word","catch","err","console","log","length","arrTitles","article","language","from","to","count","post","temparr","wordForSearching","title","articleTitle","res","render","searchContextValue"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { BrowserRouter, Route, Switch } from \"react-router-dom\";\r\nimport axios from \"axios\";\r\nimport Header from \"../components/Header\";\r\nimport Articles from \"../components/Articles\";\r\nimport Titles from \"../components/Titles\";\r\nimport Words from \"../components/Words\";\r\nimport NotFound from \"../components/NotFound\";\r\nimport { SearchContext } from \"../context/searchContext\";\r\nimport moment from \"moment\";\r\n\r\nclass AppRouter extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      searchword: \"\",\r\n      articlesFromGNews: [],\r\n      searchWordsFromDB: [],\r\n      articleTitlesFromMongo: [],\r\n    };\r\n\r\n    this.handleSearch = this.handleSearch.bind(this);\r\n    this.sendTitleToDB = this.sendTitleToDB.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    // get articles from gNews, 24h old\r\n    const time = moment().subtract(2, \"days\").toISOString().split(\".\")[0] + \"Z\";\r\n    fetch(\r\n      `https://gnews.io/api/v4/search?q=news&in=content&lang=en&from=${time}&max=9&token=ad067a361343c4bbf32705a9be330165`\r\n    )\r\n      .then(function (response) {\r\n        return response.json();\r\n      })\r\n      .then((data) => {\r\n        this.setState({ articlesFromGNews: data.articles });\r\n      });\r\n\r\n    // get from mongoDB searchwords arr\r\n    axios\r\n      .get(\"http://localhost:5000/words\")\r\n      .then((response) => {\r\n        const tempArr = [];\r\n        response.data.map((object) => tempArr.push(object.word));\r\n        this.setState({ searchWordsFromDB: tempArr });\r\n        // console.log(\r\n        //   \"approuter-searchWordsFromDB\",\r\n        //   this.state.searchWordsFromDB\r\n        // );\r\n      })\r\n      .catch((err) => {\r\n        console.log(err);\r\n      });\r\n\r\n    // get titles from mongoDB\r\n    axios.get(\"http://localhost:5000/articles\").then((response) => {\r\n      if (response.data.length > 0) {\r\n        const arrTitles = [];\r\n        response.data.map((object) => arrTitles.push(object.article));\r\n        this.setState({ articleTitlesFromMongo: arrTitles });\r\n        // console.log(\r\n        //   \"approuter-articleTitlesFromMongo\",\r\n        //   this.state.articleTitlesFromMongo\r\n        // );\r\n      }\r\n    });\r\n  }\r\n\r\n  handleSearch(searchword, language, from, to) {\r\n    this.setState({\r\n      searchword: searchword,\r\n    });\r\n    //console.log(\"searchword from handleSearch\", searchword);\r\n\r\n    // send search word to mongoDB\r\n    const word = {\r\n      word: searchword,\r\n      count: 1,\r\n    };\r\n    axios\r\n      .post(\"http://localhost:5000/words/add\", word)\r\n      .then((response) => console.log(\"response.data\", response.data));\r\n\r\n    // add word to front\r\n    let temparr = this.state.searchWordsFromDB;\r\n    temparr.push(searchword);\r\n    this.setState({\r\n      searchWordsFromDB: temparr,\r\n    });\r\n    //console.log(\"adding front\", this.state.searchWordsFromDB);\r\n\r\n    // get gNews articles by searchword\r\n\r\n    let wordForSearching = searchword === \"\" ? \"news\" : searchword;\r\n\r\n    fetch(\r\n      `https://gnews.io/api/v4/search?q=${wordForSearching}&in=content&lang=${language}&from=${from}&to=${to}&max=9&token=ad067a361343c4bbf32705a9be330165`\r\n    )\r\n      .then(function (response) {\r\n        return response.json();\r\n      })\r\n      .then((data) => {\r\n        this.setState({ articlesFromGNews: data.articles });\r\n        //console.log(this.state.articlesFromGNews);\r\n      });\r\n    //console.log(this.state.articlesFromGNews);\r\n  }\r\n\r\n  // send title to mongoDB\r\n  sendTitleToDB(title) {\r\n    //front title arr\r\n    // let tempTitlearr = this.state.articleTitlesFromMongo;\r\n    // tempTitlearr.push(title);\r\n    // this.setState({\r\n    //   articleTitlesFromMongo: tempTitlearr,\r\n    // });\r\n\r\n    const articleTitle = {\r\n      article: title,\r\n      count: 1,\r\n    };\r\n\r\n    // send title to mongoDB\r\n    axios\r\n      .post(\"http://localhost:5000/articles/add\", articleTitle)\r\n      .then((res) => console.log(res.data));\r\n\r\n    console.log(\" front-title\", title);\r\n  }\r\n\r\n  render() {\r\n    const searchContextValue = {\r\n      handleSearch: this.handleSearch,\r\n      searchWordsFromDB: this.state.searchWordsFromDB,\r\n      articlesFromGNews: this.state.articlesFromGNews,\r\n      articleTitlesFromMongo: this.state.articleTitlesFromMongo,\r\n      sendTitleToDB: this.sendTitleToDB,\r\n    };\r\n\r\n    return (\r\n      <BrowserRouter>\r\n        <SearchContext.Provider value={searchContextValue}>\r\n          <Header />\r\n          <Switch>\r\n            <Route path=\"/\" component={Articles} exact={true} />\r\n            <Route path=\"/titles\" component={Titles} />\r\n            <Route path=\"/words\" component={Words} />\r\n            <Route component={NotFound} />\r\n          </Switch>\r\n        </SearchContext.Provider>\r\n      </BrowserRouter>\r\n    );\r\n  }\r\n}\r\n\r\nexport default AppRouter;\r\n"]},"metadata":{},"sourceType":"module"}